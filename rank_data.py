# -*- coding: utf-8 -*-
"""
rank_data.py - Модуль даних для українських військових звань та їх відмінювання

Цей модуль містить комплексні словники для роботи з українськими військовими званнями,
включаючи їх граматичні форми (відмінки), жіночі форми (фемінітиви) та допоміжні
структури для автоматичного розпізнавання та перетворення звань.

Модуль використовується в:
    - data_masking.py: для маскування звань з збереженням граматичної форми та роду
    - unmask_data.py: для відновлення оригінальних звань з граматичним узгодженням

Основні компоненти:
    - RANK_DECLENSIONS: відмінки чоловічих форм звань (називний, родовий, давальний, орудний)
    - RANK_FEMININE_MAP: мапа чоловічих звань на жіночі фемінітиви
    - RANK_DECLENSIONS_FEMALE: відмінки жіночих форм звань
    - RANK_TO_NOMINATIVE: зворотний індекс для швидкого пошуку базової форми
    - ALL_RANK_FORMS: відсортований список всіх форм для розпізнавання
    - RANKS_LIST: повний список звань для генерації масок

Відмінки українських звань:
    - nominative (називний): хто? що? - "солдат", "капітан"
    - genitive (родовий): кого? чого? - "солдата", "капітана"
    - dative (давальний): кому? чому? - "солдату", "капітану"
    - instrumental (орудний): ким? чим? - "солдатом", "капітаном"

Приклад використання:
    >>> from rank_data import RANK_DECLENSIONS, RANK_TO_NOMINATIVE
    >>> # Отримати форму давального відмінка
    >>> RANK_DECLENSIONS['солдат']['dative']
    'солдату'
    >>> # Розпізнати звання та відмінок з тексту
    >>> RANK_TO_NOMINATIVE['солдату']
    ('солдат', 'dative', 'male')

Author: Vladyslav V. Prodan
Contact: github.com/click0
Phone: +38(099)6053340
Version: 2.2.14
License: BSD 3-Clause "New" or "Revised" License
Year: 2025

"""

# ============================================================================
# СЛОВНИКИ ВІДМІНКІВ ЗВАНЬ (ЧОЛОВІЧІ ФОРМИ)
# ============================================================================
# Відповідають структурі військових звань ЗСУ після реформи 2020 року.
# Кожне звання має 4 основні граматичні форми для правильного узгодження
# з контекстом речення.

RANK_DECLENSIONS = {
    # ========================================================================
    # РЯДОВІ (ПРИВАТНІ) ЗВАННЯ
    # ========================================================================
    # Найнижчі військові звання в ієрархії ЗСУ

    'рекрут': {
        'nominative': 'рекрут',      # "рекрут прибув"
        'genitive': 'рекрута',       # "наказ рекрута"
        'dative': 'рекруту',         # "рекруту наказано"
        'instrumental': 'рекрутом',  # "з рекрутом"
    },

    'рядовий': {
        'nominative': 'рядовий',     # "рядовий виконав"
        'genitive': 'рядового',      # "рапорт рядового"
        'dative': 'рядовому',        # "рядовому присвоєно"
        'instrumental': 'рядовим',   # "з рядовим"
    },

    'солдат': {
        'nominative': 'солдат',      # "солдат виконав"
        'genitive': 'солдата',       # "рапорт солдата"
        'dative': 'солдату',         # "солдату присвоєно"
        'instrumental': 'солдатом',  # "із солдатом"
    },

    'старший солдат': {
        'nominative': 'старший солдат',      # "старший солдат доповів"
        'genitive': 'старшого солдата',      # "звіт старшого солдата"
        'dative': 'старшому солдату',        # "старшому солдату наказано"
        'instrumental': 'старшим солдатом',  # "зі старшим солдатом"
    },

    # --- МОРСЬКІ РЯДОВІ ---
    # Аналоги солдатів для ВМС України

    'матрос': {
        'nominative': 'матрос',
        'genitive': 'матроса',
        'dative': 'матросу',
        'instrumental': 'матросом',
    },

    'старший матрос': {
        'nominative': 'старший матрос',
        'genitive': 'старшого матроса',
        'dative': 'старшому матросу',
        'instrumental': 'старшим матросом',
    },

    'моряк': {
        'nominative': 'моряк',
        'genitive': 'моряка',
        'dative': 'моряку',
        'instrumental': 'моряком',
    },

    'старший моряк': {
        'nominative': 'старший моряк',
        'genitive': 'старшого моряка',
        'dative': 'старшому моряку',
        'instrumental': 'старшим моряком',
    },

    # ========================================================================
    # СЕРЖАНТСЬКІ ЗВАННЯ
    # ========================================================================
    # Молодші командири підрозділів (відділення, екіпажі)

    'молодший сержант': {
        'nominative': 'молодший сержант',
        'genitive': 'молодшого сержанта',
        'dative': 'молодшому сержанту',
        'instrumental': 'молодшим сержантом',
    },

    'сержант': {
        'nominative': 'сержант',
        'genitive': 'сержанта',
        'dative': 'сержанту',
        'instrumental': 'сержантом',
    },

    'старший сержант': {
        'nominative': 'старший сержант',
        'genitive': 'старшого сержанта',
        'dative': 'старшому сержанту',
        'instrumental': 'старшим сержантом',
    },

    'головний сержант': {
        'nominative': 'головний сержант',
        'genitive': 'головного сержанта',
        'dative': 'головному сержанту',
        'instrumental': 'головним сержантом',
    },

    # --- СТАРШІ СЕРЖАНТИ ---
    # Звання введені після реформи 2020 (за стандартами НАТО)

    'штаб-сержант': {
        'nominative': 'штаб-сержант',
        'genitive': 'штаб-сержанта',
        'dative': 'штаб-сержанту',
        'instrumental': 'штаб-сержантом',
    },

    # --- ПРАПОРЩИКИ ---
    # Перехідна ланка між сержантами та офіцерами

    'прапорщик': {
        'nominative': 'прапорщик',
        'genitive': 'прапорщика',
        'dative': 'прапорщику',
        'instrumental': 'прапорщиком',
    },

    'старший прапорщик': {
        'nominative': 'старший прапорщик',
        'genitive': 'старшого прапорщика',
        'dative': 'старшому прапорщику',
        'instrumental': 'старшим прапорщиком',
    },

    # ========================================================================
    # ОФІЦЕРСЬКІ ЗВАННЯ
    # ========================================================================

    # --- МОЛОДШІ ОФІЦЕРИ ---
    # Командири взводів та їх заступники

    'молодший лейтенант': {
        'nominative': 'молодший лейтенант',
        'genitive': 'молодшого лейтенанта',
        'dative': 'молодшому лейтенанту',
        'instrumental': 'молодшим лейтенантом',
    },

    'лейтенант': {
        'nominative': 'лейтенант',
        'genitive': 'лейтенанта',
        'dative': 'лейтенанту',
        'instrumental': 'лейтенантом',
    },

    'старший лейтенант': {
        'nominative': 'старший лейтенант',
        'genitive': 'старшого лейтенанта',
        'dative': 'старшому лейтенанту',
        'instrumental': 'старшим лейтенантом',
    },

    # --- СТАРШІ ОФІЦЕРИ ---
    # Командири рот, батальйонів

    'капітан': {
        'nominative': 'капітан',
        'genitive': 'капітана',
        'dative': 'капітану',
        'instrumental': 'капітаном',
    },

    'майор': {
        'nominative': 'майор',
        'genitive': 'майора',
        'dative': 'майору',
        'instrumental': 'майором',
    },

    'підполковник': {
        'nominative': 'підполковник',
        'genitive': 'підполковника',
        'dative': 'підполковнику',
        'instrumental': 'підполковником',
    },

    'полковник': {
        'nominative': 'полковник',
        'genitive': 'полковника',
        'dative': 'полковнику',
        'instrumental': 'полковником',
    },

    # ========================================================================
    # ГЕНЕРАЛЬСЬКІ ЗВАННЯ
    # ========================================================================
    # Вищі військові звання командного складу ЗСУ

    'бригадний генерал': {
        'nominative': 'бригадний генерал',
        'genitive': 'бригадного генерала',
        'dative': 'бригадному генералу',
        'instrumental': 'бригадним генералом',
    },

    'генерал-майор': {
        'nominative': 'генерал-майор',
        'genitive': 'генерал-майора',
        'dative': 'генерал-майору',
        'instrumental': 'генерал-майором',
    },

    'генерал-лейтенант': {
        'nominative': 'генерал-лейтенант',
        'genitive': 'генерал-лейтенанта',
        'dative': 'генерал-лейтенанту',
        'instrumental': 'генерал-лейтенантом',
    },

    'генерал': {
        'nominative': 'генерал',
        'genitive': 'генерала',
        'dative': 'генералу',
        'instrumental': 'генералом',
    },

    # ========================================================================
    # СПЕЦІАЛЬНІ СЛУЖБИ - МЕДИЧНА СЛУЖБА
    # ========================================================================
    # Звання військових медиків (лікарів, медсестер тощо)
    # Формат: "[базове звання] медичної служби"

    'капітан медичної служби': {
        'nominative': 'капітан медичної служби',
        'genitive': 'капітана медичної служби',
        'dative': 'капітану медичної служби',
        'instrumental': 'капітаном медичної служби',
    },

    'майор медичної служби': {
        'nominative': 'майор медичної служби',
        'genitive': 'майора медичної служби',
        'dative': 'майору медичної служби',
        'instrumental': 'майором медичної служби',
    },

    'підполковник медичної служби': {
        'nominative': 'підполковник медичної служби',
        'genitive': 'підполковника медичної служби',
        'dative': 'підполковнику медичної служби',
        'instrumental': 'підполковником медичної служби',
    },

    'полковник медичної служби': {
        'nominative': 'полковник медичної служби',
        'genitive': 'полковника медичної служби',
        'dative': 'полковнику медичної служби',
        'instrumental': 'полковником медичної служби',
    },

    # ========================================================================
    # МОРСЬКІ ОФІЦЕРСЬКІ ЗВАННЯ
    # ========================================================================
    # Специфічні звання ВМС України (відповідають армійським рангам)

    'капітан 1-го рангу': {  # ≈ полковник
        'nominative': 'капітан 1-го рангу',
        'genitive': 'капітана 1-го рангу',
        'dative': 'капітану 1-го рангу',
        'instrumental': 'капітаном 1-го рангу',
    },

    'капітан 2-го рангу': {  # ≈ підполковник
        'nominative': 'капітан 2-го рангу',
        'genitive': 'капітана 2-го рангу',
        'dative': 'капітану 2-го рангу',
        'instrumental': 'капітаном 2-го рангу',
    },

    'капітан 3-го рангу': {  # ≈ майор
        'nominative': 'капітан 3-го рангу',
        'genitive': 'капітана 3-го рангу',
        'dative': 'капітану 3-го рангу',
        'instrumental': 'капітаном 3-го рангу',
    },

    # --- АДМІРАЛЬСЬКІ ЗВАННЯ ---

    'контр-адмірал': {  # ≈ бригадний генерал
        'nominative': 'контр-адмірал',
        'genitive': 'контр-адмірала',
        'dative': 'контр-адміралу',
        'instrumental': 'контр-адміралом',
    },

    'віце-адмірал': {  # ≈ генерал-майор
        'nominative': 'віце-адмірал',
        'genitive': 'віце-адмірала',
        'dative': 'віце-адміралу',
        'instrumental': 'віце-адміралом',
    },

    'адмірал': {  # ≈ генерал-лейтенант
        'nominative': 'адмірал',
        'genitive': 'адмірала',
        'dative': 'адміралу',
        'instrumental': 'адміралом',
    },
}

# ============================================================================
# СЛОВНИКИ ФЕМІНІТИВІВ (ЖІНОЧІ ФОРМИ ЗВАНЬ)
# ============================================================================
# З 2018 року в ЗСУ офіційно дозволено використання жіночих форм звань.
# Цей словник забезпечує правильне перетворення чоловічих звань на жіночі.

# --- МАПА ПЕРЕТВОРЕННЯ: чоловіча форма → жіноча форма ---
# Наразі фемінітиви затверджені тільки для частини звань (до майора включно)
RANK_FEMININE_MAP = {
    'солдат': 'солдатка',
    'старший солдат': 'старша солдатка',
    'молодший сержант': 'молодша сержантка',
    'сержант': 'сержантка',
    'старший сержант': 'старша сержантка',
    'молодший лейтенант': 'молодша лейтенантка',
    'лейтенант': 'лейтенантка',
    'старший лейтенант': 'старша лейтенантка',
    'капітан': 'капітанка',
    'майор': 'майорка',
}

# --- ВІДМІНКИ ЖІНОЧИХ ФОРМ ---
# Жіночі форми мають власні правила відмінювання (закінчення -а, -и, -ці, -ою)
RANK_DECLENSIONS_FEMALE = {
    'солдатка': {
        'nominative': 'солдатка',       # "солдатка виконала"
        'genitive': 'солдатки',         # "рапорт солдатки"
        'dative': 'солдатці',           # "солдатці присвоєно"
        'instrumental': 'солдаткою',    # "із солдаткою"
    },

    'старша солдатка': {
        'nominative': 'старша солдатка',
        'genitive': 'старшої солдатки',
        'dative': 'старшій солдатці',
        'instrumental': 'старшою солдаткою',
    },

    'молодша сержантка': {
        'nominative': 'молодша сержантка',
        'genitive': 'молодшої сержантки',
        'dative': 'молодшій сержантці',
        'instrumental': 'молодшою сержанткою',
    },

    'сержантка': {
        'nominative': 'сержантка',
        'genitive': 'сержантки',
        'dative': 'сержантці',
        'instrumental': 'сержанткою',
    },

    'старша сержантка': {
        'nominative': 'старша сержантка',
        'genitive': 'старшої сержантки',
        'dative': 'старшій сержантці',
        'instrumental': 'старшою сержанткою',
    },

    'молодша лейтенантка': {
        'nominative': 'молодша лейтенантка',
        'genitive': 'молодшої лейтенантки',
        'dative': 'молодшій лейтенантці',
        'instrumental': 'молодшою лейтенанткою',
    },

    'лейтенантка': {
        'nominative': 'лейтенантка',
        'genitive': 'лейтенантки',
        'dative': 'лейтенантці',
        'instrumental': 'лейтенанткою',
    },

    'старша лейтенантка': {
        'nominative': 'старша лейтенантка',
        'genitive': 'старшої лейтенантки',
        'dative': 'старшій лейтенантці',
        'instrumental': 'старшою лейтенанткою',
    },

    'капітанка': {
        'nominative': 'капітанка',
        'genitive': 'капітанки',
        'dative': 'капітанці',
        'instrumental': 'капітанкою',
    },

    'майорка': {
        'nominative': 'майорка',
        'genitive': 'майорки',
        'dative': 'майорці',
        'instrumental': 'майоркою',
    },
}

# ============================================================================
# ГЕНЕРАЦІЯ ДОПОМІЖНИХ СТРУКТУР
# ============================================================================
# Автоматичне створення зворотних індексів для швидкого пошуку та розпізнавання

# --- 1. RANK_TO_NOMINATIVE: ЗВОРОТНИЙ ІНДЕКС ---
# Структура: {будь-яка_форма_звання: (базова_чоловіча_форма, відмінок, рід)}
# Дозволяє за будь-якою формою звання (навіть у непрямому відмінку) швидко знайти:
#   - базову форму для маскування
#   - відмінок для відновлення правильної форми
#   - рід для узгодження з іменем/прізвищем
#
# Приклади:
#   "солдату" → ('солдат', 'dative', 'male')
#   "сержантці" → ('сержант', 'dative', 'female')
#   "капітана медичної служби" → ('капітан медичної служби', 'genitive', 'male')

RANK_TO_NOMINATIVE = {}

# Приклади структури після автогенерації (закоментовано):
# {
#     'солдат': ('солдат', 'nominative', 'male'),
#     'солдата': ('солдат', 'genitive', 'male'),
#     'солдату': ('солдат', 'dative', 'male'),
#     'солдатом': ('солдат', 'instrumental', 'male'),
#     'сержантка': ('сержант', 'nominative', 'female'),
#     'сержантці': ('сержант', 'dative', 'female'),
#     'капітана медичної служби': ('капітан медичної служби', 'genitive', 'male'),
#     'рядового': ('рядовий', 'genitive', 'male'),
#     ...
# }

# Додаємо всі чоловічі форми
for nominative_rank, cases in RANK_DECLENSIONS.items():
    for case_name, case_form in cases.items():
        # Зберігаємо у lower case для case-insensitive пошуку
        RANK_TO_NOMINATIVE[case_form.lower()] = (nominative_rank, case_name, 'male')

# Додаємо всі жіночі форми
for nominative_rank_female, cases in RANK_DECLENSIONS_FEMALE.items():
    # Знаходимо відповідну чоловічу базову форму
    base_male_form = None
    for male_form, female_form in RANK_FEMININE_MAP.items():
        if female_form == nominative_rank_female:
            base_male_form = male_form
            break

    # Якщо знайшли чоловічу форму, додаємо всі жіночі відмінки
    if base_male_form:
        for case_name, case_form in cases.items():
            # Зберігаємо базову ЧОЛОВІЧУ форму для уніфікації маскування
            RANK_TO_NOMINATIVE[case_form.lower()] = (base_male_form, case_name, 'female')

# --- 2. ALL_RANK_FORMS: ВІДСОРТОВАНИЙ СПИСОК ДЛЯ РОЗПІЗНАВАННЯ ---
# Список всіх можливих форм звань (усі відмінки + роди) для швидкого пошуку в тексті.
# Сортування від найдовших до найкоротших критично важливе для правильного розпізнавання
# складених звань типу "старший лейтенант" перед простим "лейтенант".
#
# Приклад проблеми без правильного сортування:
#   Текст: "старший лейтенант"
#   Якщо спочатку шукати "лейтенант", то знайдеться тільки він, а "старший" залишиться.
#   При пошуку спочатку "старший лейтенант" - розпізнається правильно як єдине звання.

ALL_RANK_FORMS = sorted(RANK_TO_NOMINATIVE.keys(), key=len, reverse=True)

# ============================================================================
# СПИСКИ ЗВАНЬ ДЛЯ МАСКУВАННЯ (КАТЕГОРИЗОВАНІ)
# ============================================================================
# Ці списки використовуються для генерації випадкових масок при маскуванні звань.
# Звання згруповані за типами для збереження правдоподібності (армійське → армійське).

# --- СУХОПУТНІ ВІЙСЬКА ---
ARMY_RANKS = [
    "рекрут", "рядовий", "солдат", "старший солдат",
    "молодший сержант", "сержант", "старший сержант", "головний сержант",
    "штаб-сержант", "мастер-сержант", "штабс-сержант", "майстер-сержант",
    "старший майстер-сержант", "головний майстер-сержант",
    "молодший лейтенант", "лейтенант", "старший лейтенант", "капітан",
    "майор", "підполковник", "полковник",
    "бригадний генерал", "генерал-майор", "генерал-лейтенант", "генерал"
]

# --- ВІЙСЬКОВО-МОРСЬКІ СИЛИ ---
NAVAL_RANKS = [
    "матрос", "моряк", "старший матрос", "старший моряк",
    "молодший сержант", "сержант", "старший сержант", "головний сержант",
    "штабс-сержант", "майстер-сержант", "старший майстер-сержант", "головний майстер-сержант",
    "молодший лейтенант", "лейтенант", "старший лейтенант", "капітан-лейтенант",
    "капітан 3-го рангу", "капітан 2-го рангу", "капітан 1-го рангу",
    "контр-адмірал", "віце-адмірал", "адмірал"
]

# --- СЛУЖБА ЮСТИЦІЇ ---
# Звання військових юристів, прокурорів
LEGAL_RANKS = [
    "молодший сержант юстиції", "сержант юстиції", "старший сержант юстиції",
    "головний сержант юстиції", "штабс-сержант юстиції",
    "молодший лейтенант юстиції", "лейтенант юстиції", "старший лейтенант юстиції", "капітан юстиції",
    "майор юстиції", "підполковник юстиції", "полковник юстиції",
    "генерал-майор юстиції", "генерал-лейтенант юстиції"
]

# --- МЕДИЧНА СЛУЖБА ---
# Звання військових медиків
MEDICAL_RANKS = [
    "молодший сержант медичної служби", "сержант медичної служби", "старший сержант медичної служби",
    "головний сержант медичної служби", "штабс-сержант медичної служби",
    "молодший лейтенант медичної служби", "лейтенант медичної служби",
    "старший лейтенант медичної служби", "капітан медичної служби",
    "майор медичної служби", "підполковник медичної служби", "полковник медичної служби",
    "генерал-майор медичної служби", "генерал-лейтенант медичної служби"
]

# ============================================================================
# ФІНАЛЬНА ГЕНЕРАЦІЯ ПОВНОГО СПИСКУ ЗВАНЬ
# ============================================================================
# Об'єднуємо всі категорії звань + всі граматичні форми для максимально
# повного покриття при розпізнаванні в тексті.

# Збираємо всі відмінкові форми з обох словників
_DECLENSION_FORMS_LIST = []

# Приклади значень після автогенерації (закоментовано):
# [
#     'рекрут', 'рекрута', 'рекруту', 'рекрутом',
#     'рядовий', 'рядового', 'рядовому', 'рядовим',
#     'солдат', 'солдата', 'солдату', 'солдатом',
#     'старший солдат', 'старшого солдата', 'старшому солдату', 'старшим солдатом',
#     'сержант', 'сержанта', 'сержанту', 'сержантом',
#     'солдатка', 'солдатки', 'солдатці', 'солдаткою',
#     'сержантка', 'сержантки', 'сержантці', 'сержанткою',
#     'капітан медичної служби', 'капітана медичної служби', ...
#     'контр-адмірал', 'контр-адмірала', ...
#     ...
# ]

# Додаємо всі форми чоловічих звань
for rank_dict in RANK_DECLENSIONS.values():
    _DECLENSION_FORMS_LIST.extend(rank_dict.values())

# Додаємо всі форми жіночих звань
for rank_dict in RANK_DECLENSIONS_FEMALE.values():
    _DECLENSION_FORMS_LIST.extend(rank_dict.values())

# Об'єднуємо категоризовані списки + всі граматичні форми
RAW_RANKS_LIST = (
        ARMY_RANKS +
        NAVAL_RANKS +
        LEGAL_RANKS +
        MEDICAL_RANKS +
        _DECLENSION_FORMS_LIST
)

# --- ЕКСПОРТОВАНИЙ ВІДСОРТОВАНИЙ СПИСОК ---
# Фінальний список для використання в regex та пошуку:
#   1. Видаляємо дублікати через set()
#   2. Сортуємо за довжиною (від найдовших до найкоротших)
#   3. Це забезпечує правильне розпізнавання складених звань
RANKS_LIST = sorted(set(RAW_RANKS_LIST), key=len, reverse=True)
